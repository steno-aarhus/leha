---
title: "Recoding variables documentation"
format: html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Recoding variables in UKB

All coding relies on the ukbAid packages (REF)

### Smoking

**Smoking status** For people who want to use smoking status only,
p20116 can be used as it contains the categories current; former; never
smokers. <https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=20116>

**Smoking heaviness** As previously coded by Clift et al. [1], when
wanting a more detailed smoking classification five groups can be
created by combining p20116 and p3456 (number of cigarettes currently
smoked daily; <https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=3456>).
Clift et al. categorized participants as light smokers (\<10
cigarettes/day), moderate smokers (10--19 cigarettes/day) and heavy
smokers (â‰¥20 cigarettes/day). For time to event analyses, smoking
heaviness should be based on the most recent information collected prior
to baseline of the study. As an example, the leha repository is a
prospective cohort study investigating dietary habits and risk of liver
disease. The project will run Cox regression including follow-up time
for participants immediately following the inclusion into the UK Biobank
and thus only include the baseline measure of cigarettes smoked daily in
the smoking variable.

-   First recode number of cigarettes (p3456)

```{r}
data <- data %>%
  mutate(cigday_groups = case_when(
    p3456_i0 < 10 ~ 0,
    p3456_i0 >= 10 & p3456_i0 < 19 ~ 1,
    p3456_i0 >= 19 ~ 2
  ))
```

-1 represents "Do not know" -3 represents "Prefer not to answer" Above
needs to be recoded

When recoded we need to merge p20116 and new_variable somehow

```{r}
data <- data %>% 
  dplyr::mutate(smoke_heaviness = )
```

Long-term smoking exposure Smoking behaviour was self-reported by
participants at baseline at the assessment centres. Participants were
asked about smoking status (current, former or never), age of
initiation, and cigarettes smoked per day. A variable reflecting
lifetime smoking behaviour was generated by combining the smoking
measures into an index and a half-life constant reflecting the
exponential decrease in effect of smoking at a given time on health. A
detailed overview of the construction of this variable can be found
elsewhere. [10]

<https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0285258#references>

1.  Clift, A.K., A. von Ende, P.S. Tan, H.M. Sallis, N. Lindson, C.A.C.
    Coupland, et al., Smoking and COVID-19 outcomes: an observational
    and Mendelian randomisation study using the UK Biobank cohort.
    Thorax, 2022. 77(1): p. 65-73

### Townsend deprivation index

The Townsend Deprivation Score is an area based score of social
deprivation (unemployment, overcrowding, non- car ownership and non-
home ownership) that was determined immediately prior to the participant
joining the Biobank, based on data from the preceding national census.
Each participant was assigned a score corresponding to their postcode
area based on the Index of Multiple Deprivation from Scotland, Wales and
England. Townsend Deprivation Index has previously been coded as a
categorical variable ranging 1 to 5 with 1 being "most affluent" and 5
being "most deprived" [2].

Missing/unknown have in the Nuffield Dept. group been coded as 9 (REF)

```{r}
data <- data %>% 
  dplyr::mutate(quintile = ntile(p22189, 5))
```

[2] Woodward M, Peters SAE, Harris K. Social deprivation as a risk
factor for COVID-19 mortality among women and men in the UK Biobank:
nature of risk and context suggests that social interventions are
essential to mitigate the effects of future pandemics. J Epidemiol
Community Health. 2021 Nov;75(11):1050-1055. doi:
10.1136/jech-2020-215810. Epub 2021 Apr 27. PMID: 33906905; PMCID:
PMC8098299.
